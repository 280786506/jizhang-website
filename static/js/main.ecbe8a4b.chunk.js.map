{"version":3,"sources":["components/Layout.tsx","hooks/useUpdate.tsx","hooks/useRecords.tsx","lib/createId.tsx","hooks/useTags.tsx","hooks/usedisplay.tsx","views/Money/CategorySection.tsx","components/Input.tsx","views/Money/NotesSection.tsx","views/Money/NumberPadSection/NumberPadSection.tsx","views/Money/NumberPadSection.tsx","views/Money/TagsSection.tsx","views/Money.tsx","views/Statistics/Statistics.tsx","views/Statistics.tsx","views/NoMatch.tsx","App.tsx","index.tsx"],"names":["Wrapper","styled","div","Main","Layout","props","className","children","useUpdate","fn","deps","count","useRef","useEffect","current","useRecords","useState","records","setRecords","JSON","parse","window","localStorage","getItem","setItem","stringify","addRecord","newRecord","amount","status","msg","tagIds","length","record","id","parseInt","createId","useTags","tags","setTags","_tags","name","icon","findTag","filter","tag","findTagIndex","result","i","updateTag","obj","deleteTag","addTag","prompt","getName","t","getIcon","useDisplay","display","setDisplay","useDisplayFormState","useBetween","section","CategorySection","categoryList","category","value","categoryMap","map","c","onClick","onChange","Label","label","Input","rest","NotesSection","note","e","target","placeholder","NumberPadSection","toString","output","_setOutput","setOutput","newOutput","slice","parseFloat","numberList","text","textContent","indexOf","onOK","TagsSection","selectedTagIds","components","SkinTwoTone","BankTwoTone","SmileTwoTone","CarTwoTone","DollarCircleTwoTone","Story","SpecificStory","tagId","index","console","log","onToggleTag","MyLayout","Flex","_day","day","date","_month","month","_year","year","currentDate","defaultFormData","createdAt","Money","selected","setSelected","open","setOpen","dateFormat","openDatePicker","dateString","inputReadOnly","locale","bordered","format","defaultValue","moment","allowClear","suffixIcon","DownOutlined","res","alert","setTimeout","location","reload","Title","BackGround","Total","Content","Note","span","Scroll","Button","button","Display","Icon","Mask","Statistics","time","newRecords","setNewRecords","decimal","number","numberString","list","split","recordMap","_income","_expenditure","n","r","Y","M","d","push","data","newn","sort","a","b","A_Y","B_Y","A_M","B_M","A_D","B_D","y","m","setIncome","setExpenditure","income","expenditure","picker","listItem","NoMatch","App","exact","from","to","path","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.ecbe8a4b.chunk.js","sourcesContent":["import React from 'react';\r\nimport styled from 'styled-components';\r\nimport Nav from 'components/Nav';\r\n\r\nconst Wrapper = styled.div`\r\n  height:100vh;\r\n  display:flex;\r\n  flex-direction:column;\r\n`\r\n\r\nconst Main = styled.div`\r\n  flex-grow:1;\r\n  overflow:hidden;\r\n`\r\nconst Layout = (props: any) => {\r\n  return (\r\n    <Wrapper>\r\n      <Main className={props.className}>\r\n        {props.children}\r\n      </Main>\r\n      {/* <Nav></Nav> */}\r\n    </Wrapper>\r\n\r\n  )\r\n}\r\nexport default Layout","import { useEffect, useRef } from \"react\"\r\n\r\nexport const useUpdate = (fn:()=>void,deps:any[])=>{\r\n    const count = useRef(0)\r\n  // []什么都不写，就是第一次渲染的时候执行\r\n  useEffect(()=>{\r\n    count.current +=1\r\n  })\r\n  // useEffect 在数据变化或者 render的时候执行\r\n  useEffect(()=>{\r\n    if(count.current > 1){\r\n        fn()\r\n    }\r\n  },deps)\r\n}\r\n// export {useUpdate}","import { useEffect, useState } from 'react';\r\nimport { useUpdate } from './useUpdate';\r\n\r\n\r\ntype newRecordItem = {\r\n    tagIds:number[]\r\n    note:string\r\n    category:'+' | '-'\r\n    amount:number,\r\n    createdAt:string\r\n}\r\n\r\n// type RecordItem = newRecordItem & {\r\n//     createdAt:string // ISO 8601\r\n// }\r\n\r\nconst useRecords = ()=>{\r\n    const [records,setRecords] = useState<newRecordItem[]>([])\r\n\r\n    useEffect(()=>{\r\n        setRecords(JSON.parse(window.localStorage.getItem('records') || '[]') )\r\n    },[])\r\n\r\n    const addRecord = (newRecord:newRecordItem) =>{\r\n        if(newRecord.amount <=0 ){ return {status:0,msg:'请输入金额'} }\r\n        if(newRecord.tagIds.length === 0){\r\n            return {status:0,msg:'请选择标签'}\r\n        }\r\n        const record = {...newRecord}\r\n        setRecords([...records,record])\r\n        \r\n        return {status:1,msg:'保存成功'}\r\n    }\r\n\r\n    useUpdate(()=>{\r\n        window.localStorage.setItem('records',JSON.stringify(records))\r\n    },[records])\r\n\r\n    return{records,addRecord}\r\n}\r\n\r\nexport {useRecords}","let id = parseInt(window.localStorage.getItem('idMax') || '0');\r\nconst createId = ()=>{\r\n    id+=1;\r\n    window.localStorage.setItem('inMax',JSON.stringify(id))\r\n    return id \r\n}\r\nexport {createId}","import { useUpdate } from 'hooks/useUpdate';\r\nimport { createId } from 'lib/createId';\r\nimport { useEffect, useState } from 'react';\r\n\r\nconst useTags = ()=>{\r\n  const [tags,setTags] = useState<{id:number,name:string,icon:string}[]>\r\n  ([])\r\n  useEffect(()=>{\r\n    let _tags = JSON.parse(window.localStorage.getItem('tags') || '[]')\r\n    if(_tags.length === 0 ){\r\n      _tags = [\r\n        {id:createId(),name:'消费',icon:'SkinTwoTone'},\r\n        {id:createId(),name:'美食',icon:'SmileTwoTone'},\r\n        {id:createId(),name:'住宿',icon:'BankTwoTone'},\r\n        {id:createId(),name:'交通',icon:'CarTwoTone'},\r\n        {id:createId(),name:'收入',icon:'DollarCircleTwoTone'},\r\n\r\n      ]\r\n    }\r\n    setTags(_tags)\r\n  },[])\r\n\r\n\r\n  useUpdate(()=>{\r\n    window.localStorage.setItem('tags',JSON.stringify(tags))\r\n  },[tags])\r\n\r\n  const findTag = (id:number) => tags.filter(tag => tag.id === id)[0]\r\n  const findTagIndex = (id:number) =>{\r\n    let result = -1\r\n    for(let i=0;i<tags.length;i++){\r\n      if(tags[i].id === id){\r\n        result = i\r\n        break;\r\n      }\r\n    }\r\n    return result\r\n  }\r\n  const updateTag = (id:number,obj:{name:string}) => {\r\n    // setTags(tags.map(tag=>tag.id ===id ?{id,name:obj.name}:tag) )\r\n  }\r\n\r\n  const deleteTag = (id:number) =>{\r\n    setTags(tags.filter(tag=> tag.id !== id))\r\n  }\r\n  const addTag = ()=>{\r\n    const tagName = window.prompt('新标签名称为');\r\n    if(tagName !== null && tagName!== ''){\r\n      // setTags([...tags,{id:createId(),name:tagName}])\r\n    }\r\n  }\r\n\r\n  const getName = (id:number)=>{\r\n    const tag = tags.filter(t=>t.id===id)[0]\r\n    return tag? tag.name :''\r\n  }\r\n\r\n  const getIcon = (id:number)=>{\r\n    const tag = tags.filter(t=>t.id===id)[0]\r\n    return tag? tag.icon :''\r\n  }\r\n    return {tags,setTags,findTag,findTagIndex,updateTag,deleteTag,addTag,getName,getIcon}\r\n}\r\n\r\nexport {useTags}","import { useState } from \"react\"\r\nimport { useBetween } from 'use-between';\r\nconst useDisplay = ()=>{\r\n    const [display, setDisplay] = useState<boolean>(false)\r\n    return {display,setDisplay}\r\n}\r\nconst useDisplayFormState = () => useBetween(useDisplay);\r\nexport {useDisplayFormState}","import React from \"react\";\r\nimport { useState } from \"react\"\r\nimport styled from \"styled-components\"\r\nimport { useDisplayFormState } from \"hooks/usedisplay\";\r\nconst Wrapper = styled.section`\r\n  font-size:12px;\r\n  background:white;\r\n  color:#999;\r\n  flex:1;\r\n  display: flex;\r\n  > ul {\r\n    margin:15px 0;\r\n    flex:1;\r\n    display: flex;\r\n    > li{\r\n      text-align:center;\r\n      padding:8px;\r\n      background:#dadada;\r\n      border-radius:8px;\r\n      margin-left:12px;\r\n      &.selected{\r\n        background:rgb(235,241,255);\r\n        color:rgb(28,94,207);\r\n      }\r\n    }\r\n  }\r\n  >button{\r\n    border:none;\r\n    margin:15px ;\r\n    padding:8px;\r\n    border-radius:8px;\r\n    background:#dadada;\r\n    color:#999;\r\n    margin-right:12px;\r\n  }\r\n`\r\ntype Props = {\r\n  value :'-'|'+';\r\n  onChange:(value:'-'|'+')=>void\r\n}\r\nconst CategorySection: React.FC<Props> = (props) => {\r\n  const [categoryList] = useState<('-'|'+')[]>(['-', '+']);\r\n\r\n  const category = props.value\r\n\r\n  const categoryMap = {'-':'支出','+':'收入'};\r\n\r\n  const { setDisplay } = useDisplayFormState()\r\n  const close = ()=>{\r\n    setDisplay(false)\r\n  }\r\n  return (\r\n    <Wrapper>\r\n      <ul>\r\n        {categoryList.map(c => \r\n          <li \r\n            key={c}\r\n            className={category === c ? 'selected' : ''}\r\n            onClick={() => { props.onChange(c) }}\r\n          >\r\n            {categoryMap[c]}\r\n          </li>\r\n        )}\r\n\r\n      </ul>\r\n      <button onClick={close}>关闭</button>\r\n\r\n    </Wrapper>\r\n  )\r\n}\r\n\r\nexport {CategorySection};\r\n","import React from 'react';\r\nimport styled from 'styled-components';\r\n\r\nconst Label = styled.label`\r\n    display: flex;\r\n    align-items:center;\r\n    > span {margin-right:16px;white-space:nowrap}\r\n    > input {\r\n      display:block;\r\n      width:100%;\r\n      height:42px;\r\n      background:none;\r\n      border:none;\r\n    }\r\n`\r\ntype Props ={\r\n    label:string;\r\n} & React.InputHTMLAttributes<HTMLInputElement>\r\nconst Input :React.FC<Props> = (props) =>{\r\n    const {label,children,...rest} = props\r\n    return(\r\n        <Label >\r\n            <span>{props.label}</span>\r\n            <input {...rest} />\r\n        </Label>\r\n    )\r\n}\r\n   \r\n\r\n\r\nexport {Input}","import styled from \"styled-components\"\r\nimport React, { ChangeEventHandler } from \"react\";\r\nimport { Input } from \"components/Input\";\r\n\r\nconst Wrapper = styled.section`\r\n  background:#ffffff;\r\n  padding:0px 14px;\r\n  font-size:14px;\r\n \r\n`\r\ntype Props = {\r\n  value:string;\r\n  onChange:(value:string)=> void\r\n}\r\nconst NotesSection: React.FC<Props> = (props) => {\r\n  const note = props.value\r\n  // 非受控组件\r\n  const onChange: ChangeEventHandler<HTMLInputElement> = (e)=>{\r\n      props.onChange(e.target.value)\r\n  }\r\n  /*\r\n    函数组件不支持 ref\r\n\r\n    受控组件\r\n    value={note}\r\n    onChange={(e)=>setNote(e.target.value)}\r\n\r\n    非受控组件\r\n    defaultValue={note}\r\n    onBlur={x}\r\n\r\n    受控组件是指用户每次输入值或是组件的值改变的时候都会触发事件\r\n    非受控是焦点消失时候才会触发事件，不关注过程只关注结果\r\n  */\r\n  return (\r\n    <Wrapper>\r\n      <Input label=\"备注\"  value={note}\r\n        onChange={onChange} placeholder=\"添加备注\" >\r\n        {/* <span>备注</span>\r\n        <input placeholder=\"添加备注\" \r\n        type=\"text\" \r\n        defaultValue={note}\r\n        onBlur={onBlur}\r\n        /> */}\r\n      </Input>\r\n    </Wrapper>\r\n  )\r\n}\r\n\r\nexport { NotesSection }","import styled from \"styled-components\";\r\n\r\nconst Wrapper = styled.section`\r\n  display: flex;\r\n  flex-direction:column;\r\n  > .output{\r\n    background:#fff;\r\n    font-size:36px;\r\n    line-height:72px;\r\n    text-align:right;\r\n    padding:0 16px;\r\n    box-shadow:inset 0 5px 5px -5px rgba(0,0,0,0,0.25);\r\n    border-top:5px solid #fcfcfc;\r\n\r\n  }\r\n  >.pad{\r\n    > button{\r\n      border:none;\r\n      border:5px solid #fcfcfc;\r\n      font-size:18px;\r\n      float:left;\r\n      width:25%;\r\n      height:64px;\r\n      background:#ffffff;\r\n      &.ok{\r\n        height:128px;\r\n        float:right;\r\n      }\r\n      &.zero{\r\n        width:50%;\r\n      }\r\n    }\r\n  }\r\n`\r\nexport { Wrapper }\r\n","import { useState } from 'react';\r\nimport React from 'react';\r\nimport {Wrapper} from 'views/Money/NumberPadSection/NumberPadSection'\r\n\r\ntype Props = { \r\n  value:number ;\r\n  onChange:(value:number)=>void;\r\n  onOK?:()=>void\r\n}\r\n\r\nconst NumberPadSection: React.FC<Props> = (props) => {\r\n  const [output,_setOutput] = useState(props.value.toString())\r\n  const setOutput = (output:string)=>{\r\n    let newOutput:string\r\n    // let value:string\r\n    if(output.length>16){\r\n      newOutput =output.slice(0,16)\r\n    }else if(output.length === 0){\r\n      newOutput = '0'\r\n    }else{\r\n      newOutput = output\r\n    }\r\n    _setOutput(newOutput)\r\n    props.onChange(parseFloat(newOutput))\r\n  }\r\n\r\n  const numberList = ['0','1','2','3','4','5','6','7','8','9']\r\n  const onClickButtonWrapper = (e:React.MouseEvent)=>{\r\n    const text = (e.target as HTMLButtonElement).textContent\r\n    if(text === null) return\r\n    if(text){\r\n      if(numberList.indexOf(text)>=0){\r\n        if(output === '0'){\r\n          setOutput(text)\r\n        }else{\r\n          if(output.indexOf('.') > -1 ){\r\n            const index = output.indexOf('.')\r\n            if(index + 2 >= output.length){\r\n              setOutput(output + text)\r\n            }\r\n          }else{\r\n            setOutput(output + text)\r\n          }\r\n        }\r\n      }\r\n      if(text === '删除'){\r\n        if(output.length === 1){\r\n          setOutput('')\r\n        }else{\r\n          setOutput(output.slice(0,-1) || '')\r\n        }\r\n      }\r\n      if(text === '清空'){\r\n        setOutput('')\r\n      }\r\n      if(text === '.'){\r\n        if(output.indexOf('.')===-1){\r\n          setOutput(output + '.')\r\n        }\r\n      }\r\n\r\n      if(text === 'OK'){\r\n        if(props.onOK){\r\n          props.onOK()\r\n        }\r\n      }\r\n\r\n    }\r\n  }\r\n  return (\r\n    <Wrapper>\r\n      <div className=\"output\">{output}</div>\r\n      <div className=\"pad clearfix\" \r\n      onClick={onClickButtonWrapper}>\r\n        <button>1</button>\r\n        <button>2</button>\r\n        <button>3</button>\r\n        <button>删除</button>\r\n        <button>4</button>\r\n        <button>5</button>\r\n        <button>6</button>\r\n        <button>清空</button>\r\n        <button>7</button>\r\n        <button>8</button>\r\n        <button>9</button>\r\n        <button className=\"ok\">OK</button>\r\n        <button className=\"zero\">0</button>\r\n        <button >.</button>\r\n      </div>\r\n    </Wrapper>\r\n  )\r\n}\r\n\r\nexport { NumberPadSection }","import styled from \"styled-components\"\r\nimport { useTags } from \"hooks/useTags\";\r\nimport { SkinTwoTone, BankTwoTone, SmileTwoTone, CarTwoTone, PlusSquareTwoTone,DollarCircleTwoTone } from '@ant-design/icons';\r\n\r\n\r\n\r\nconst Wrapper = styled.section`\r\n  flex-grow:1;\r\n  background:#fff;\r\n  padding: 12px 16px;\r\n  display: flex;\r\n  flex-direction:column;\r\n  justify-content:flex-end;\r\n  align-items:flex-start;\r\n  > ol{\r\n    margin: 0 -16px;\r\n    >li{\r\n      background:#f1f1f1;\r\n      border-radius:8px;\r\n      display:inline-block;\r\n      padding:5px 12px;\r\n      margin:8px 9.5px;\r\n      height:44px;\r\n      color:rgb(24 144 255);\r\n      text-align:center;\r\n      > div{\r\n        display: flex;\r\n        flex-direction:column;\r\n        align-items:center;\r\n        > p{\r\n          font-size:12px;\r\n          /* margin-top:5px; */\r\n        }\r\n        >span{\r\n          \r\n        }\r\n      }\r\n      &.selected {\r\n        background:#e6f7ff;\r\n        color:rgb(24 ,144 255);\r\n      }\r\n    }\r\n   \r\n  }\r\n  /* > button{\r\n    background:none;\r\n    border:none;\r\n    margin-top:10px; \r\n  } */\r\n`;\r\ntype Props = {\r\n  value: number[];\r\n  onChange: (selected: number[]) => void;\r\n}\r\nconst TagsSection: React.FC<Props> = (props) => {\r\n  const { tags, addTag } = useTags()\r\n\r\n  const selectedTagIds = props.value\r\n\r\n  const onToggleTag = (tagId: number) => {\r\n    const index = selectedTagIds.indexOf(tagId)\r\n    console.log(index)\r\n\r\n    if (index >= 0) {\r\n      props.onChange(selectedTagIds.filter(t => t !== tagId))\r\n    } else {\r\n      props.onChange([tagId])\r\n    }\r\n  }\r\n\r\n  const isSelected = (tagId: number) => selectedTagIds.indexOf(tagId) >= 0 ? 'selected' : ''\r\n\r\n  const components: any = {\r\n    'SkinTwoTone': SkinTwoTone,\r\n    'BankTwoTone': BankTwoTone,\r\n    'SmileTwoTone': SmileTwoTone,\r\n    'CarTwoTone': CarTwoTone,\r\n    'DollarCircleTwoTone':DollarCircleTwoTone\r\n  };\r\n  const Story = (name: string) => {\r\n    const SpecificStory = components[name];\r\n    return <SpecificStory />;\r\n  }\r\n\r\n  return (\r\n    <Wrapper>\r\n      <ol>\r\n        {tags.map(tag =>\r\n          <li key={tag.id}\r\n            onClick={() => { onToggleTag(tag.id) }}\r\n            className={isSelected(tag.id)}\r\n            id={tag.id.toString()}\r\n          >\r\n            <div>\r\n              <span>{Story(tag.icon)}</span>\r\n              <p>{tag.name} </p>\r\n            </div>\r\n\r\n          </li>\r\n        )}\r\n        {/* <li onClick={addTag} >\r\n          <div>\r\n            <span>\r\n              <PlusSquareTwoTone />\r\n            </span>\r\n            <span>加 </span>\r\n          </div>\r\n        </li> */}\r\n      </ol>\r\n    </Wrapper>\r\n  )\r\n}\r\n\r\nexport { TagsSection }","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { CategorySection } from \"./Money/CategorySection\";\r\nimport { NotesSection } from \"./Money/NotesSection\";\r\nimport { NumberPadSection } from \"./Money/NumberPadSection\";\r\nimport { TagsSection } from \"./Money/TagsSection\";\r\nimport { useState } from 'react';\r\nimport { useRecords } from \"hooks/useRecords\";\r\nimport { useDisplayFormState } from \"hooks/usedisplay\";\r\n\r\nimport { DatePicker } from 'antd';\r\nimport { DownOutlined } from '@ant-design/icons';\r\n\r\n\r\nimport day from 'dayjs'\r\n\r\nimport moment from 'moment';\r\nimport 'moment/locale/zh-cn';\r\nimport locale from 'antd/es/date-picker/locale/zh_CN';\r\n\r\nconst MyLayout = styled.div`\r\n  display: flex;\r\n  flex-direction:column;\r\n`\r\nconst Flex = styled.div`\r\ndisplay: flex;\r\nbackground: #fff;\r\nposition:relative;\r\nalign-items:center;\r\n  >.ant-picker{\r\n    padding:4px 0 4px 15px;\r\n  }\r\n  >.anticon{\r\n    margin-left:-20px;\r\n    margin-right:10px;\r\n    z-index:11;\r\n  }\r\n`\r\n\r\ntype Category = '-' | '+'\r\nconst _day: number = day().date()\r\nconst _month = day().month() + 1\r\nconst _year = day().year()\r\nconst currentDate = `${_year}/${_month}/${_day}`\r\n\r\nconst defaultFormData = {\r\n  tagIds: [] as number[],\r\n  note: '',\r\n  category: '-' as Category,\r\n  amount: 0,\r\n  createdAt:currentDate,\r\n}\r\nfunction Money() {\r\n  const [selected, setSelected] = useState(defaultFormData)\r\n\r\n  const { addRecord } = useRecords()\r\n\r\n  // Partial<typeof selected> 某个类型的部分类型\r\n  const onChange = (obj: Partial<typeof selected>) => {\r\n    setSelected({\r\n      ...selected,\r\n      ...obj\r\n    })\r\n  }\r\n  const { setDisplay } = useDisplayFormState()\r\n  const onOk = () => {\r\n    const res = addRecord(selected)\r\n    alert(res.msg)\r\n    if (res.status === 1) {\r\n      setSelected(defaultFormData)\r\n      setTimeout(() => {\r\n        setDisplay(false)\r\n        window.location.reload()\r\n      }, 50);\r\n    }\r\n  }\r\n\r\n\r\n  const [open, setOpen] = useState<boolean>(false)\r\n\r\n  const dateFormat = 'YYYY/MM/DD'\r\n  const DatePickeronChange = (date:any,dateString:any) => {\r\n    console.log(date,dateString)\r\n    setSelected({\r\n      ...selected,\r\n      createdAt:dateString\r\n    })\r\n    setOpen(!open)\r\n  }\r\n\r\n  const openDatePicker = () => {\r\n    setOpen(!open)\r\n  }\r\n  return (\r\n    <MyLayout>\r\n      <Flex>\r\n          <DatePicker onChange={DatePickeronChange}\r\n            inputReadOnly={true}\r\n            locale={locale} bordered={false}\r\n            format={dateFormat}\r\n            defaultValue={moment(currentDate, dateFormat)}\r\n            allowClear={false}\r\n            open={open}\r\n            suffixIcon=''\r\n            onClick={openDatePicker} />\r\n        <DownOutlined onClick={openDatePicker} />\r\n\r\n        <CategorySection value={selected.category}\r\n          onChange={category => onChange({ category })} />\r\n      </Flex>\r\n      <TagsSection\r\n        value={selected.tagIds}\r\n        onChange={tagIds => onChange({ tagIds })}\r\n      />\r\n\r\n      <NotesSection value={selected.note}\r\n        onChange={note => onChange({ note })}\r\n      />\r\n\r\n      <NumberPadSection\r\n        value={selected.amount}\r\n        onChange={amount => onChange({ amount })}\r\n        onOK={onOk} />\r\n    </MyLayout>\r\n  )\r\n}\r\nexport default Money;","import styled from \"styled-components\"\r\n\r\nconst Flex = styled.div`\r\ndisplay: flex;\r\nflex-direction:column;\r\nheight:100vh;\r\n`\r\n\r\nconst Wrapper = styled.div`\r\n padding:0 16px;\r\n .ant-picker{\r\n  padding:4px 0;\r\n }\r\n .anticon {\r\n   color:#fff;\r\n   margin-left:-20px\r\n }\r\n .ant-picker.ant-picker-borderless{\r\n   width:100px;\r\n }\r\n .ant-picker-input > input{\r\n   color:#fff\r\n }\r\n`\r\nconst Title = styled.div`\r\n  font-size:18px;\r\n  font-weight:bold;\r\n  color:white;\r\n  padding:16px 0;\r\n`\r\n\r\nconst BackGround = styled.div`\r\n position:absolute;\r\n height:130px;\r\n width:100%;\r\n top:0;\r\n background:rgb(16,108,255);\r\n z-index:-1;\r\n`\r\n\r\nconst Total = styled.div`\r\n  background:#fff;\r\n  padding:10px;\r\n  margin-top:15px;\r\n  border-radius:8px;\r\n  display: flex;\r\n  font-size:14px;\r\n  & div {\r\n    flex:1;\r\n  }\r\n    & p {\r\n      margin:0;\r\n      margin-top:15px;\r\n      font-size:24px;\r\n      font-weight:bold\r\n      \r\n    }\r\n`\r\nconst Content = styled.div`\r\n  margin-top:15px;\r\n  background:white;\r\n  padding:20px 10px;\r\n  border-radius:8px;\r\n  & div{\r\n    display: flex;\r\n    /* margin-top:15px; */\r\n    padding:15px 0;\r\n  }\r\n  & p{\r\n    color:#999;\r\n  }\r\n`\r\nconst Note = styled.span`\r\n flex:1;\r\n color:#999;\r\n margin-left:10px;\r\n`\r\n\r\nconst Scroll = styled.div`\r\noverflow-y:scroll;\r\n/* height:80vh; */\r\nflex:1;\r\npadding:0 16px;\r\nmargin-top:15px;\r\npadding-bottom:30px;\r\n`\r\n\r\nconst Button = styled.button`\r\n    position:absolute;\r\n    right:15px;\r\n    bottom:10px;\r\n    height:40px;\r\n    width:40px;\r\n    padding:15px;\r\n    border-radius:50%;\r\n    border:none;\r\n    background:rgb(16,108,255);\r\n    color:white;\r\n    font-size:22px;\r\n    line-height:13px;\r\n    font-weight:bold;\r\n    text-align:center;\r\n    box-shadow:0 0 10px #999;\r\n`\r\n\r\nconst Display = styled.div`\r\n  position:absolute;\r\n  z-index:10;\r\n  bottom:0;\r\n  width:100%;\r\n  display: flex;\r\n  flex-direction: column-reverse;\r\n  /* height: 100vh; */\r\n`\r\n\r\nconst Icon = styled.span`\r\n  background:#e6f7ff;\r\n  padding:8px;\r\n  margin-right:5px;\r\n  border-radius:8px;\r\n`\r\n\r\nconst Mask = styled.div`\r\n  position:absolute;\r\n  top:0;\r\n  bottom:0;\r\n  left:0;\r\n  right:0;\r\n  background:rgba(0,0,0,0.5);\r\n\r\n`\r\nexport {Flex,Wrapper,Title,BackGround,Total,Content,Note,Scroll,Button,Display,Icon,Mask}","import Layout from \"components/Layout\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useRecords } from 'hooks/useRecords';\r\nimport { useTags } from \"hooks/useTags\";\r\nimport day from 'dayjs'\r\nimport Money from 'views/Money';\r\nimport { useDisplayFormState } from \"hooks/usedisplay\";\r\nimport { Wrapper, Title, BackGround, Total, Content, Note, Scroll, Button, Display, Flex, Icon, Mask } from \"./Statistics/Statistics\"\r\n\r\n\r\nimport { DatePicker } from 'antd';\r\nimport { DownOutlined } from '@ant-design/icons';\r\n\r\nimport moment from 'moment';\r\nimport 'moment/locale/zh-cn';\r\nimport locale from 'antd/es/date-picker/locale/zh_CN';\r\n\r\nimport { SkinTwoTone, BankTwoTone, SmileTwoTone, CarTwoTone, PlusSquareTwoTone, DollarCircleTwoTone } from '@ant-design/icons';\r\n\r\n\r\n\r\ntype RecordItem = {\r\n  tagIds: number[]\r\n  note: string\r\n  category: '+' | '-'\r\n  amount: number\r\n  createdAt: string // ISO 8601\r\n}\r\n\r\n\r\nfunction Statistics() {\r\n  const { records } = useRecords()\r\n  const { getName, getIcon } = useTags()\r\n  let time: string[] = []\r\n  // let newRecords: { date: string, list: RecordItem[] }[] = []\r\n  const [newRecords, setNewRecords] = useState<{ date: string, list: RecordItem[] }[]>([])\r\n\r\n  const decimal = (number: number) => {\r\n    let numberString = JSON.stringify(number)\r\n    if (numberString.indexOf('.') === -1) {\r\n      return numberString += '.00'\r\n    } else {\r\n      const list = JSON.parse(JSON.stringify(numberString)).split('.')\r\n      if (list[list.length - 1].length === 0) {\r\n        return numberString += '00'\r\n      }\r\n      else if (list[list.length - 1].length === 1) {\r\n        return numberString += '0'\r\n      }\r\n      else {\r\n        return numberString\r\n      }\r\n    }\r\n  }\r\n\r\n  const recordMap = (year: string | number, month: string | number) => {\r\n    let _income = 0\r\n    let _expenditure = 0\r\n    time = []\r\n    let n: { date: string, list: RecordItem[] }[] = []\r\n    records.map(r => {\r\n      const Y: string = day(r.createdAt).format('YYYY')\r\n      const M: string = day(r.createdAt).format('MM')\r\n\r\n      if (Y == year && M == month) {\r\n        const d: string = day(r.createdAt).format('YYYY年MM月DD日')\r\n        const index = time.indexOf(d)\r\n        if (index === -1) {\r\n          time.push(d)\r\n          let data = {\r\n            date: d,\r\n            list: [r]\r\n          }\r\n          n.push(data)\r\n        } else {\r\n          n[index].list.push(r)\r\n        }\r\n\r\n        if (r.category === '-') {\r\n          _expenditure += r.amount\r\n        } else {\r\n          _income += r.amount\r\n        }\r\n      }\r\n    })\r\n\r\n\r\n\r\n    const newn = JSON.parse(JSON.stringify(n))\r\n\r\n    newn.sort((a: any, b: any) => {\r\n      let A_Y = a.date.split('年')\r\n      let B_Y = b.date.split('年')\r\n\r\n      let A_M = A_Y[1].split('月')\r\n      let B_M = B_Y[1].split('月')\r\n\r\n      let A_D = A_M[1].split('日')\r\n      let B_D = B_M[1].split('日')\r\n      a['y'] = A_Y[0]\r\n      a['m'] = A_M[0]\r\n      a['d'] = A_D[0]\r\n\r\n      b['y'] = B_Y[0]\r\n      b['m'] = B_M[0]\r\n      b['d'] = B_D[0]\r\n\r\n      if (a.y === b.y) {\r\n\r\n        if (a.m === b.m) {\r\n\r\n          if (a.d === b.d) {\r\n\r\n            return a.d - b.d\r\n\r\n          } else {\r\n\r\n            return b.d - a.d\r\n\r\n          }\r\n\r\n        } else {\r\n\r\n          return b.m - a.m\r\n\r\n        }\r\n\r\n      } else {\r\n\r\n        return b.y - a.y\r\n\r\n      }\r\n\r\n    })\r\n\r\n    setNewRecords(newn)\r\n    setIncome(decimal(_income))\r\n    setExpenditure(decimal(_expenditure))\r\n  }\r\n\r\n  const listSort = (list: any[]) => {\r\n    return list.sort((a: any, b: any) => {\r\n      const A_Y = a.date.split('年')\r\n      const B_Y = b.date.split('年')\r\n\r\n      const A_M = A_Y[1].split('月')\r\n      const B_M = B_Y[1].split('月')\r\n\r\n      const A_D = A_M[1].split('日')\r\n      const B_D = B_M[1].split('日')\r\n\r\n      if (A_Y[0] === B_Y[0]) {//如果id相同，按照age的降序\r\n        if (A_M[0] === B_M[0]) {\r\n          if (A_D[0] === B_D[0]) {\r\n            return b - a\r\n          } else {\r\n            console.log(A_D[0], B_D[0])\r\n            if (A_D[0] > B_D[0]) {\r\n              console.log(5)\r\n              return b - a\r\n            } else {\r\n              console.log(6)\r\n              return a - b\r\n            }\r\n          }\r\n        } else {\r\n          return a - b\r\n        }\r\n      } else {\r\n        return a - b\r\n      }\r\n      // const a_Y = a.date.split('年')\r\n      // const b_Y = b.date.split('年')\r\n    })\r\n  }\r\n\r\n  let { display, setDisplay } = useDisplayFormState()\r\n  const add = () => {\r\n    setOpen(false)\r\n    setDisplay(true)\r\n  }\r\n\r\n  const _day: number = day().date()\r\n  const _month = day().month() + 1\r\n  const _year = day().year()\r\n  const currentDate = `${_year}/${_month}/${_day}`\r\n  const [income, setIncome] = useState<any>('0') //本月收入\r\n  const [expenditure, setExpenditure] = useState<any>('0') //本月支出\r\n  const dateFormat = 'YYYY年MM月'\r\n\r\n  useEffect(() => {\r\n    recordMap(_year, _month)\r\n  }, [records])\r\n\r\n  const onChange = (date: any, dateString: any) => {\r\n    const Y = JSON.parse(JSON.stringify(dateString)).split('年')\r\n    const M = Y[1].split('月')[0]\r\n    recordMap(Y[0], M)\r\n    setOpen(false)\r\n  }\r\n\r\n  const [open, setOpen] = useState<boolean>(false)\r\n  const openDatePicker = () => {\r\n    setOpen(!open)\r\n  }\r\n\r\n  const components: any = {\r\n    'SkinTwoTone': SkinTwoTone,\r\n    'BankTwoTone': BankTwoTone,\r\n    'SmileTwoTone': SmileTwoTone,\r\n    'CarTwoTone': CarTwoTone,\r\n    'DollarCircleTwoTone': DollarCircleTwoTone\r\n  };\r\n  const Story = (name: string) => {\r\n    const SpecificStory = components[name];\r\n    return <SpecificStory />;\r\n  }\r\n  const close = () => {\r\n    setDisplay(false)\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      <Flex>\r\n        <BackGround></BackGround>\r\n        <Wrapper>\r\n          <Title>记账本</Title>\r\n          <DatePicker onChange={onChange}\r\n            inputReadOnly={true}\r\n            picker=\"month\"\r\n            locale={locale} bordered={false}\r\n            format={dateFormat}\r\n            defaultValue={moment(currentDate, dateFormat)}\r\n            allowClear={false}\r\n            open={open}\r\n            suffixIcon=''\r\n            onClick={openDatePicker}\r\n             />\r\n          <DownOutlined onClick={openDatePicker} />\r\n          <Total>\r\n            <div>本月总支出\r\n            <p>￥{expenditure}</p>\r\n            </div>\r\n            <div>本月总收入\r\n            <p>￥{income}</p>\r\n            </div>\r\n          </Total>\r\n        </Wrapper>\r\n        <Button onClick={add}>+</Button>\r\n\r\n        <Scroll>\r\n          {\r\n            newRecords.map(r => {\r\n              return <Content key={r.date}>\r\n                <p>{r.date}</p>\r\n                {r.list.map((listItem, index) => {\r\n                  return <div key={index}>\r\n                    {listItem.tagIds.map(tagId => <span key={tagId}>\r\n                      <Icon>{Story(getIcon(tagId))}</Icon>\r\n                      {getName(tagId)}\r\n                    </span>)}\r\n                    <Note>{listItem.note}</Note>\r\n                    {listItem.category} {decimal(listItem.amount)}\r\n                  </div>\r\n                })}\r\n              </Content>\r\n            })\r\n          }\r\n        </Scroll>\r\n\r\n        {display &&\r\n          <div>\r\n            <Mask onClick={close}/>\r\n            <Display >\r\n              <Money></Money>\r\n            </Display>\r\n          </div>\r\n        }\r\n\r\n\r\n      </Flex>\r\n    </Layout>\r\n  )\r\n}\r\nexport default Statistics;","import React from \"react\";\r\n\r\nfunction NoMatch() {\r\n    return <div>404</div>\r\n  }\r\nexport default NoMatch;","import React from 'react';\nimport {\n  HashRouter as Router,\n  Switch,\n  Route,\n  Redirect\n} from \"react-router-dom\";\n\nimport Tags from 'views/Tags';\nimport Money from 'views/Money';\nimport Statistics from 'views/Statistics';\nimport NoMatch from 'views/NoMatch';\nimport Tag from 'views/Tag';\n\n\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        {/* 默认路由 */}\n        <Redirect exact from=\"/\" to=\"statistics\"></Redirect>\n        {/* <Route exact path=\"/tags\">\n          <Tags />\n        </Route>\n        <Route exact path=\"/tags/:id\">\n          <Tag />\n        </Route>\n        <Route exact path=\"/money\">\n          <Money />\n        </Route> */}\n        <Route exact path=\"/statistics\">\n          <Statistics />\n        </Route>\n        {/* 404 */}\n        <Route path=\"*\">\n          <NoMatch></NoMatch>\n        </Route>\n      </Switch>\n    </Router>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport 'index.scss'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}